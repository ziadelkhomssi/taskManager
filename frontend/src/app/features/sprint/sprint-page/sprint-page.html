<app-entity-card
  [entity]="sprintDetails"
  entityName="Sprint"
  [showManipulateOptions]="clientDetails.permissions.canManipulateTicket || false"
  [update]="updateSprint"
  [delete]="deleteSprint"
>
  <div class="sprint-details" details>
    <div class="sprint-text">
        <div class="sprint-title">
          <h4 class="section-label">Sprint</h4>
          <h1>{{ sprintDetails.title }}</h1>
        </div>

        <div class="sprint-description">
          <h2>Description</h2>
          <p>{{ sprintDetails.description }}</p>
        </div>

        <app-sprint-status-chip
          class="sprint-status"
          [status]="sprintDetails.status"
        />

        <div class="sprint-participants">
          <app-user-list-preview-button
            [previewUsers]="previewParticipants"
            [avatarSize]="30"
            (clicked)="onOpenParticipantList()"
          />
        </div>
      </div>

      <div class="sprint-meta">
        <div class="meta-item">
          <span class="meta-label">Start Date</span>
          <span class="meta-value">
            {{ sprintDetails.startDate | date:"yyyy-MM-dd" }}
          </span>
        </div>

        <div class="meta-item">
          <span class="meta-label">Due Date</span>
          <span class="meta-value">
            {{ sprintDetails.dueDate | date:"yyyy-MM-dd" }}
          </span>
        </div>

        @if (sprintDetails.endDate) {
          <div class="meta-item">
            <span class="meta-label">End Date</span>
            <span class="meta-value">
              {{ sprintDetails.endDate | date:"yyyy-MM-dd" }}
            </span>
          </div>
        }
      </div>
  </div>
</app-entity-card>

<app-crud-table
  [columns]="columns"
  [showManipulateOptions]="clientDetails.permissions.canManipulateTicket || false"
  [filters]="filters"
  entityName="Ticket"
  [view]="viewTicket"
  [create]="createTicket"
  [update]="updateTicket"
  [delete]="deleteTicket"
  [pageQuery]="loadTickets"
  >
</app-crud-table>

<ng-template #ticketStatusTemplate let-status>
  <app-ticket-status-chip [status]="status"></app-ticket-status-chip>
</ng-template>
